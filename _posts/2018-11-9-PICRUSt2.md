---
layout: post
title:  "PICRUSt2对16s数据进行功能注释"
date:  2018-11-09 15:40:07     
categories: 16s
tags: 16s python qiime2
---

* content
{:toc}

**功能注释，看样子qiime2和picrust2谈妥了，更了个插件，介绍下用法**

* 安装插件，前提是conda安装了qiime2

```shell
source activate qiime2-2018.8
conda install -c anaconda -c defaults -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda -c https://conda.anaconda.org/biocore q2-fragment-insertion
```
* 下载并安装PICRUSt2


```shell
wget https://github.com/picrust/picrust2/releases/download/v2.0.3-b/picrust2-2.0.3-b.zip
unzip picrust2-2.0.3-b.zip
cd picrust2-2.0.3-b
conda-env update -n qiime2-2018.8 -f picrust2-env.yaml
pip install --editable .
```
* 测试安装

```
pytest tests/test_hsp.py tests/test_metagenome_pipeline.py tests/test_run_minpath.py tests/test_util.py
```
* 下载q2-picrust2插件GitHub Repo并安装
```shell
cd ..
wget https://github.com/gavinmdouglas/q2-picrust2/releases/download/v0.0.1/q2-picrust2-0.0.1.zip
unzip q2-picrust2-0.0.1.zip
cd q2-picrust2-0.0.1
python setup.py install
qiime dev refresh-cache
cd ..
```
* 准备文件
rep-seqs.qza
aligned-sequences.qza
unrooted-tree.qza
sequences.qza 
这些上面文章有提到怎么准备
```
qiime vsearch cluster-features-closed-reference \
  --i-table table.qza \
  --i-sequences rep-seqs.qza \
  --i-reference-sequences sequences.qza  \
  --p-perc-identity 0.99 \
  --o-clustered-table table-cr-99.qza \
  --o-clustered-sequences rep-seqs-cr-99.qza \
  --o-unmatched-sequences unmatched-cr-99.qza
qiime fragment-insertion sepp --i-representative-sequences rep-seqs.qza \
                              --p-threads 1 \
                              --i-reference-alignment aligned-sequences.qza \ 
                              --i-reference-phylogeny unrooted-tree.qza\
                              --output-dir fragment_insertion_out
qiime picrust2 custom-tree-pipeline --i-table table-cr-99.qza \
                                    --i-tree tutorial_placed_out/tree.qza \
                                    --output-dir q2-picrust2_output \
                                    --p-threads 60 --p-hsp-method pic \
                                    --p-max-nsti 2
```


